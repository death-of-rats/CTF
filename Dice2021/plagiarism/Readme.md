# plagiarism

I didn't solve this challenge. After CTF I read the writeup and mentioned in it article and implement GDC in python with SageMath.

## Challenge

Can I copy your CTF challenge?

Yeah, just change it up a bit so it doesn't look obvious you copied.

https://hxp.io/blog/1/RuCTF%20Quals%202014:%20Crypto%20500%20%22decrypt%20message%22%20writeup/

>Two agents, Blex and Kane, have simultaneously known very secret message and transmitted it to Center. You know following:
>1) They used RSA with this public key
>2) They sent exactly the same messages except the signatures (name appended, eg. "[message]Blex")
>3) They did encryption this way:
>
>m = int(message.encode("hex"), 16)
>c = pow(m, e, N)
>
>4) And here are cryptograms you have intercepted:
>
>N = 25898966400928827905718377946331123070958718286581765316565582158865227877882475404853218079499084099440419144196215764927720893687968939899067275095801562867742359933997487928281899714724738097735994026225339488710478292473051567851786254924548138570069406420407124627567648479424564834446192417334669768477661434992797176428220265984651288944265998446714590797833756720922745187467388408600309665467669255896919554072379878017822219455974525233467767926938557154083882126002952139561283708342676308894318951822068027821029295524097544028901807902120777407151278396388621981625398417573347316888458337381776303199529
>
>e = 1048577
>
>ciphertext_Blex = 11140520553087800834883326476247582685177207584737264356946559762068509060522907835540767944557089926814767920501376431871780404000550271362410228709616559148950928004959648199391157781102695421411667843970881959939688515679415870087007797819271601359811630724878746762862603629420061133824605384527474682526549557804674160851967543475275374840169790764048711047622418045734436512050742433282306694490346907876574514077395835974083376649624559301087384766644865104383786285302561584731767419571603248493060257358632833957327996996960955767927114473513709882904104552609194519132931270741118197821776138632855021619178
>
>ciphertext_Kane = 2922817623733019475805146570530296261205732600738503605503192845278422660686627490817081424885152809772315629265930072636690234953045955503581182067349322827011065359648958225896393305011175960879100475146203207801533980643261035226402857047007061320653920746872424363923515091038846823007819033456503365649022294092944985887626605207259444051959239244136999684366533551627508385114998024232490369665950339127904350803268889205463047713233591604324960184727360413931125906144631968128488876241314939855024305076160092193380013725939761970042406866169417457376487954247442308318888399299295082898238584625937490546472
>
>Now tell me that secret message! (The answer for this task starts from 'dice{') 

## Solution

So we have two ciphertexts:

<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>C</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><mo>=</mo><msubsup><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>e</mi></mrow></msubsup><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1191" style="width: 9.364em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.089em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.651em, 1007.04em, 2.965em, -1000em); top: -2.489em; left: 0em;"><span class="mrow" id="MathJax-Span-1192"><span class="msubsup" id="MathJax-Span-1193"><span style="display: inline-block; position: relative; width: 1.1em; height: 0px;"><span style="position: absolute; clip: rect(3.183em, 1000.71em, 4.179em, -1000em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-1194" style="font-family: STIXMathJax_Normal; font-style: italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="texatom" id="MathJax-Span-1195"><span class="mrow" id="MathJax-Span-1196"><span class="mn" id="MathJax-Span-1197" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mo" id="MathJax-Span-1198" style="font-family: STIXMathJax_Main; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-1199" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.177em; height: 0px;"><span style="position: absolute; clip: rect(3.189em, 1000.7em, 4.167em, -1000em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-1200" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑃<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.53em, 1000.39em, 4.174em, -1000em); top: -4.357em; left: 0.787em;"><span class="texatom" id="MathJax-Span-1201"><span class="mrow" id="MathJax-Span-1202"><span class="mi" id="MathJax-Span-1203" style="font-size: 70.7%; font-family: STIXMathJax_Normal; font-style: italic;">𝑒</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.364em, 1000.43em, 4.167em, -1000em); top: -3.691em; left: 0.594em;"><span class="texatom" id="MathJax-Span-1204"><span class="mrow" id="MathJax-Span-1205"><span class="mn" id="MathJax-Span-1206" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1207" style="font-family: STIXMathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-1208" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑚</span><span class="mi" id="MathJax-Span-1209" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑜</span><span class="mi" id="MathJax-Span-1210" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑑</span><span class="mo" id="MathJax-Span-1211" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-1212" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑁<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.05em;"></span></span><span class="mo" id="MathJax-Span-1213" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.489em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.485em; border-left: 0px solid; width: 0px; height: 1.449em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>=</mo><msubsup><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>e</mi></mrow></msubsup><mtext>&nbsp;</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-84"> C_{1} = P_{1}^{e} \text{   }mod(N) </script></p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>C</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msub><mo>=</mo><msubsup><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>e</mi></mrow></msubsup><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1214" style="width: 9.364em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.089em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.651em, 1007.04em, 2.965em, -1000em); top: -2.489em; left: 0em;"><span class="mrow" id="MathJax-Span-1215"><span class="msubsup" id="MathJax-Span-1216"><span style="display: inline-block; position: relative; width: 1.1em; height: 0px;"><span style="position: absolute; clip: rect(3.183em, 1000.71em, 4.179em, -1000em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-1217" style="font-family: STIXMathJax_Normal; font-style: italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="texatom" id="MathJax-Span-1218"><span class="mrow" id="MathJax-Span-1219"><span class="mn" id="MathJax-Span-1220" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mo" id="MathJax-Span-1221" style="font-family: STIXMathJax_Main; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-1222" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.177em; height: 0px;"><span style="position: absolute; clip: rect(3.189em, 1000.7em, 4.167em, -1000em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-1223" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑃<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.53em, 1000.39em, 4.174em, -1000em); top: -4.357em; left: 0.787em;"><span class="texatom" id="MathJax-Span-1224"><span class="mrow" id="MathJax-Span-1225"><span class="mi" id="MathJax-Span-1226" style="font-size: 70.7%; font-family: STIXMathJax_Normal; font-style: italic;">𝑒</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.364em, 1000.43em, 4.167em, -1000em); top: -3.691em; left: 0.594em;"><span class="texatom" id="MathJax-Span-1227"><span class="mrow" id="MathJax-Span-1228"><span class="mn" id="MathJax-Span-1229" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1230" style="font-family: STIXMathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-1231" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑚</span><span class="mi" id="MathJax-Span-1232" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑜</span><span class="mi" id="MathJax-Span-1233" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑑</span><span class="mo" id="MathJax-Span-1234" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-1235" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑁<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.05em;"></span></span><span class="mo" id="MathJax-Span-1236" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.489em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.485em; border-left: 0px solid; width: 0px; height: 1.449em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>=</mo><msubsup><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>e</mi></mrow></msubsup><mtext>&nbsp;</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-85"> C_{2} = P_{2}^{e} \text{   }mod(N) </script></p>

where second text is simply first with known difference:

<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msub><mo>=</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><mo>+</mo><mi>&amp;#x03B4;</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1237" style="width: 6.604em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.978em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.659em, 1004.97em, 2.802em, -1000em); top: -2.489em; left: 0em;"><span class="mrow" id="MathJax-Span-1238"><span class="msubsup" id="MathJax-Span-1239"><span style="display: inline-block; position: relative; width: 1.023em; height: 0px;"><span style="position: absolute; clip: rect(3.189em, 1000.7em, 4.167em, -1000em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-1240" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑃<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.594em;"><span class="texatom" id="MathJax-Span-1241"><span class="mrow" id="MathJax-Span-1242"><span class="mn" id="MathJax-Span-1243" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mo" id="MathJax-Span-1244" style="font-family: STIXMathJax_Main; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-1245" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.023em; height: 0px;"><span style="position: absolute; clip: rect(3.189em, 1000.7em, 4.167em, -1000em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-1246" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑃<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.594em;"><span class="texatom" id="MathJax-Span-1247"><span class="mrow" id="MathJax-Span-1248"><span class="mn" id="MathJax-Span-1249" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mo" id="MathJax-Span-1250" style="font-family: STIXMathJax_Main; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-1251" style="font-family: STIXMathJax_Normal; font-style: italic; padding-left: 0.25em;">𝛿</span></span><span style="display: inline-block; width: 0px; height: 2.489em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.223em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>=</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>+</mo><mi>δ</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-86"> P_{2} = P_{1}+\delta </script></p>

so we have after substitution:


<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>f</mi><mo>=</mo><msubsup><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>e</mi></mrow></msubsup><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>C</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1252" style="width: 11.799em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.929em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.651em, 1008.93em, 2.965em, -1000em); top: -2.489em; left: 0em;"><span class="mrow" id="MathJax-Span-1253"><span class="mi" id="MathJax-Span-1254" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-1255" style="font-family: STIXMathJax_Main; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-1256" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.177em; height: 0px;"><span style="position: absolute; clip: rect(3.189em, 1000.7em, 4.167em, -1000em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-1257" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑃<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.53em, 1000.39em, 4.174em, -1000em); top: -4.357em; left: 0.787em;"><span class="texatom" id="MathJax-Span-1258"><span class="mrow" id="MathJax-Span-1259"><span class="mi" id="MathJax-Span-1260" style="font-size: 70.7%; font-family: STIXMathJax_Normal; font-style: italic;">𝑒</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.364em, 1000.43em, 4.167em, -1000em); top: -3.691em; left: 0.594em;"><span class="texatom" id="MathJax-Span-1261"><span class="mrow" id="MathJax-Span-1262"><span class="mn" id="MathJax-Span-1263" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1264" style="font-family: STIXMathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-1265" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑚</span><span class="mi" id="MathJax-Span-1266" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑜</span><span class="mi" id="MathJax-Span-1267" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑑</span><span class="mo" id="MathJax-Span-1268" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-1269" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑁<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.05em;"></span></span><span class="mo" id="MathJax-Span-1270" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-1271" style="font-family: STIXMathJax_Main; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-1272" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.1em; height: 0px;"><span style="position: absolute; clip: rect(3.183em, 1000.71em, 4.179em, -1000em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-1273" style="font-family: STIXMathJax_Normal; font-style: italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.671em;"><span class="texatom" id="MathJax-Span-1274"><span class="mrow" id="MathJax-Span-1275"><span class="mn" id="MathJax-Span-1276" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.489em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.485em; border-left: 0px solid; width: 0px; height: 1.449em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo>=</mo><msubsup><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>e</mi></mrow></msubsup><mtext>&nbsp;</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-87">f = P_{1}^{e} \text{ }mod(N)-C_{1}</script></p>

<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>g</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><mo>+</mo><mi>&amp;#x03B4;</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>e</mi></mrow></msup><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1277" style="width: 14.667em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.093em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.602em, 1011.09em, 2.839em, -1000em); top: -2.489em; left: 0em;"><span class="mrow" id="MathJax-Span-1278"><span class="mi" id="MathJax-Span-1279" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑔</span><span class="mo" id="MathJax-Span-1280" style="font-family: STIXMathJax_Main; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-1281" style="font-family: STIXMathJax_Main; padding-left: 0.313em;">(</span><span class="msubsup" id="MathJax-Span-1282"><span style="display: inline-block; position: relative; width: 1.023em; height: 0px;"><span style="position: absolute; clip: rect(3.189em, 1000.7em, 4.167em, -1000em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-1283" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑃<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.594em;"><span class="texatom" id="MathJax-Span-1284"><span class="mrow" id="MathJax-Span-1285"><span class="mn" id="MathJax-Span-1286" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mo" id="MathJax-Span-1287" style="font-family: STIXMathJax_Main; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-1288" style="font-family: STIXMathJax_Normal; font-style: italic; padding-left: 0.25em;">𝛿</span><span class="msubsup" id="MathJax-Span-1289"><span style="display: inline-block; position: relative; width: 0.723em; height: 0px;"><span style="position: absolute; clip: rect(3.166em, 1000.29em, 4.344em, -1000em); top: -4.004em; left: 0em;"><span class="mo" id="MathJax-Span-1290" style="font-family: STIXMathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; top: -4.417em; left: 0.333em;"><span class="texatom" id="MathJax-Span-1291"><span class="mrow" id="MathJax-Span-1292"><span class="mi" id="MathJax-Span-1293" style="font-size: 70.7%; font-family: STIXMathJax_Normal; font-style: italic;">𝑒</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1294" style="font-family: STIXMathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-1295" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑚</span><span class="mi" id="MathJax-Span-1296" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑜</span><span class="mi" id="MathJax-Span-1297" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑑</span><span class="mo" id="MathJax-Span-1298" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-1299" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑁<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.05em;"></span></span><span class="mo" id="MathJax-Span-1300" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-1301" style="font-family: STIXMathJax_Main; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-1302" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.844em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.4em, 4.178em, -1000em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-1303" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.415em;"><span class="texatom" id="MathJax-Span-1304"><span class="mrow" id="MathJax-Span-1305"><span class="mn" id="MathJax-Span-1306" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.489em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.318em; border-left: 0px solid; width: 0px; height: 1.346em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>g</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>+</mo><mi>δ</mi><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>e</mi></mrow></msup><mtext>&nbsp;</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-88">g = (P_{1}+\delta)^{e} \text{ }mod(N)-c_{2}</script></p>

Calculating <span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi><mi>C</mi><mi>D</mi><mo stretchy=&quot;false&quot;>(</mo><mi>f</mi><mo>,</mo><mi>g</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1307" style="width: 5.901em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.437em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.651em, 1004.39em, 2.839em, -1000em); top: -2.489em; left: 0em;"><span class="mrow" id="MathJax-Span-1308"><span class="mi" id="MathJax-Span-1309" style="font-family: STIXMathJax_Normal; font-style: italic;">𝐺</span><span class="mi" id="MathJax-Span-1310" style="font-family: STIXMathJax_Normal; font-style: italic;">𝐶<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mi" id="MathJax-Span-1311" style="font-family: STIXMathJax_Normal; font-style: italic;">𝐷</span><span class="mo" id="MathJax-Span-1312" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-1313" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-1314" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-1315" style="font-family: STIXMathJax_Normal; font-style: italic; padding-left: 0.188em;">𝑔</span><span class="mo" id="MathJax-Span-1316" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.489em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.318em; border-left: 0px solid; width: 0px; height: 1.282em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mi>C</mi><mi>D</mi><mo stretchy="false">(</mo><mi>f</mi><mo>,</mo><mi>g</mi><mo stretchy="false">)</mo></math></span></span> will give us common dividor <span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mo>&amp;#x2217;</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><mo>&amp;#x2212;</mo><mi>b</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1317" style="width: 5.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.221em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.659em, 1004.2em, 2.802em, -1000em); top: -2.489em; left: 0em;"><span class="mrow" id="MathJax-Span-1318"><span class="mi" id="MathJax-Span-1319" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑎</span><span class="mo" id="MathJax-Span-1320" style="font-family: STIXMathJax_Main; padding-left: 0.25em;">∗</span><span class="msubsup" id="MathJax-Span-1321" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.023em; height: 0px;"><span style="position: absolute; clip: rect(3.189em, 1000.7em, 4.167em, -1000em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-1322" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑃<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.594em;"><span class="texatom" id="MathJax-Span-1323"><span class="mrow" id="MathJax-Span-1324"><span class="mn" id="MathJax-Span-1325" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mo" id="MathJax-Span-1326" style="font-family: STIXMathJax_Main; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-1327" style="font-family: STIXMathJax_Normal; font-style: italic; padding-left: 0.25em;">𝑏</span></span><span style="display: inline-block; width: 0px; height: 2.489em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.223em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>∗</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>−</mo><mi>b</mi></math></span></span> so <span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><mo>=</mo><mfrac><mi>b</mi><mi>a</mi></mfrac></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1328" style="width: 4.007em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.03em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.435em, 1003.03em, 3.003em, -1000em); top: -2.489em; left: 0em;"><span class="mrow" id="MathJax-Span-1329"><span class="msubsup" id="MathJax-Span-1330"><span style="display: inline-block; position: relative; width: 1.023em; height: 0px;"><span style="position: absolute; clip: rect(3.189em, 1000.7em, 4.167em, -1000em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-1331" style="font-family: STIXMathJax_Normal; font-style: italic;">𝑃<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.594em;"><span class="texatom" id="MathJax-Span-1332"><span class="mrow" id="MathJax-Span-1333"><span class="mn" id="MathJax-Span-1334" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mo" id="MathJax-Span-1335" style="font-family: STIXMathJax_Main; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-1336" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.475em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.37em, 1000.32em, 4.174em, -1000em); top: -4.424em; left: 50%; margin-left: -0.166em;"><span class="mi" id="MathJax-Span-1337" style="font-size: 70.7%; font-family: STIXMathJax_Normal; font-style: italic;">𝑏</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.53em, 1000.33em, 4.174em, -1000em); top: -3.659em; left: 50%; margin-left: -0.177em;"><span class="mi" id="MathJax-Span-1338" style="font-size: 70.7%; font-family: STIXMathJax_Normal; font-style: italic;">𝑎</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(0.852em, 1000.48em, 1.245em, -1000em); top: -1.302em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.475em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.489em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.536em; border-left: 0px solid; width: 0px; height: 1.784em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>=</mo><mfrac><mi>b</mi><mi>a</mi></mfrac></math></span></span>.

```python

def franklin(n, e, delta, c1, c2):
    R = PolynomialRing(Zmod(n), 'X')
    X = R.gen()
    f1 = (X)**e - c1
    f2 = (X + delta)**e - c2
    r = gcd(f1, f2)
    co = r.coefficients()
    return -co[0]//co[1]

```

The 'problem' was calculating GCD in a reasonable time. The attached [article](polydivide.pdf) describes the algorithm with time approximation $O(nlg^{2}n)$. Its implementation in python with SageMath is:

```python

def gcd(a0,a1):
    while True:
        print(a0.degree(), end=", ", flush=True)
        if a0 % a1 == 0:
            return a1
        if a0.degree() == a1.degree():
            a1 = a0%a1
        R = hgcd(a0,a1)
        [b0,b1] = R.dot(np.array([a0,a1]).transpose()).transpose()
        if b0%b1==0:
            return b1
        c = b0 % b1
        a0 = b1
        a1 = c


def hgcd(a0,a1):
    if a1.degree() <= (a0.degree()//2):
        return np.array([[1,0],[0,1]])

    m = a0.degree()//2
    X = a0.variables()[0]
    b0 = a0 // X**m
    b1 = a1 // X**m
    
    R = hgcd(b0,b1)
    [d,e] = (R.dot(np.array([a0,a1]).transpose())).transpose()
    ff = d % e
    m = m // 2
    g0 = e // X**m
    g1 = ff // X**m

    S = hgcd(g0,g1)
    q = d // e
    return S.dot(np.array([[0,1],[1,-q]])).dot(R)

```

The complete implementation is in the [sol.py](sol.py) file.