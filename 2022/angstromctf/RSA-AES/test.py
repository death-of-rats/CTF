from Crypto.Cipher import AES
from Crypto.Random import get_random_bytes
from Crypto.Util.Padding import pad
from Crypto.Util.number import long_to_bytes, bytes_to_long

d = 6939842401192591121734987906752587245890061674132299121701225442382842067764039668652328699672383437043020475460305195741308771990106640404072487819172928981195203135431620566757570847154658791067135360456831173111795034307546371705310122204965732368002504236215569944917819495610553172064350244407722705726779950842939416856688350900937391297793156361970425401834222208765308134550815138084431002958641575681048362621060848707903209002223186224150428170316897580755806313761372979684359108114747048822425236542115249545967974464243439666000827897452100022638567865824970888498575221273968847274554834303990380428245
n = 23100028007870325783185834854225420810294934833542002516071573559725954624158254241681531108254811992152391330196659130138562293154330788367194811021643366683965159626531673375163335903802878418922588761148831560375220232790576797320885239420328061465883494343484169205143945161452020074030236272423633651542587783663231883652666578166091932882621607201276775089510876377814861854076054384741632988719559243513691909274012936697373832908759138215954796841768884521430353724961486282715856244282784138169211412655478210437529819247752450082552313348995988653427767077759405830302351589964380906097867393519224077222417
e = 65537

m = bytes_to_long(b'actf{it_is_just_a_test_flag}')
c = pow(m,e,n)

bits = len(bin(m)[2:])
b = []
last_len = bits
for i in range(1,bits):
    dl = len(bin(pow(c*pow(2**i,-e,n)%n,d,n))[2:])
    if dl == last_len-1:
        b.append(0)
    else:
        b.append(1)
    last_len = dl